{% extends 'base.html' %}

{% block title %}Search{% endblock %}

{% block content %}

<div class="jumbotron">
      <div class="container">
    <h3> Search Results </h3>
    <form action="/search_results" method="POST">
      <div class="form-group">
        <input name='query' type="text" class="form-control" id="searchInput" placeholder="Enter search string" required>
      </div>
      <button type="submit" class="btn btn-primary">Search</button>
    </form>
    <table id="searchResultsTable" class="table" >
      <thead>
        <tr>
          <th>Manufacturer Name</th>
          <th>Model Name</th>
        </tr>
      </thead>
      <tbody id="searchResultsBody">
       {% if output %}
           {% for item in output %}
                <tr>
                    <td>{{ item[0] }}</td>
                    <td>{{ item[1] }}</td>
                </tr>
           {% endfor %}
        {% endif %}
      </tbody>
    </table>
          <br>
          <br>
          <div >
            <a href="{{ url_for('reporting')}}" class="btn btn-primary btn-lg report-button">Back</a>
          </div>
  </div>
<script>
    window.addEventListener("DOMContentLoaded", (event) => {
        const searchValue = document.getElementById('searchInput').value; // Replace this with your specified string
        const table = document.getElementById("searchResultsTable");
        const rows = table.getElementsByTagName("tr");

        for (let i = 0; i < rows.length; i++) {
            const cells = rows[i].getElementsByTagName("td");
            for (let j = 0; j < cells.length; j++) {
                const cellText = cells[j].innerText;
                const regex = new RegExp(searchValue, "gi");
                if (regex.test(cellText)) {
                    const highlightedText = cellText.replace(regex, match => `<span style="background-color: blue !important ">${match}</span>`);
                    cells[j].innerHTML = highlightedText;
        }
    }
}
    });
</script>
</div>

{% endblock %}